# Feature Plan: Mutual Fund Dividend Tracking

**Status: üìù Planned**
**Feature ID:** FR4.5.1
**Title:** Implement Tracking for Mutual Fund Dividends (IDCW)
**User Story:** As a mutual fund investor, I want to log dividend payouts (IDCW - Income Distribution cum Capital Withdrawal), so that I can accurately track my total returns and the income generated by my portfolio.

---

## 1. Objective

This feature introduces the ability for users to manually log dividend payments from their mutual fund holdings. This will be integrated into the existing transaction form, providing a consistent user experience with other income-tracking features.

---

## 2. High-Level Requirements

When a user selects "Mutual Fund" as the asset type in the transaction form, the "Type" dropdown will be enhanced to include a "Dividend" option.

---

## 3. Detailed Feature Breakdown

### 3.1. Backend
*   The existing `DIVIDEND` transaction type will be used.
*   The backend logic will need to correctly associate this dividend transaction with a mutual fund asset. No major changes are expected as the current dividend logic is asset-agnostic.

### 3.2. Frontend
*   **`TransactionFormModal.tsx`:**
    *   When `asset_type` is "Mutual Fund", the "Type" dropdown (currently showing "Buy" and "Sell") will be updated to also include "Dividend".
    *   When "Dividend" is selected, the form will hide the "Quantity" and "Price" fields and show a "Total Dividend Amount" field and a "Payment Date" field.
    *   An option for "Reinvested?" will be included. If checked, the frontend will construct a `BUY` transaction payload instead of a `DIVIDEND` one, using the dividend amount to calculate the quantity and NAV.

### 3.3. Analytics
*   The analytics engine (`crud_analytics.py`) must be verified to ensure that cash dividends from mutual funds are correctly included as positive cash flows in XIRR calculations.

---

## 4. Testing Plan
*   **E2E Test:** Create a new test case where a user adds a mutual fund holding, logs a cash dividend, and verifies that the income is correctly reflected in analytics.
*   **Unit Tests:** Update unit tests for `TransactionFormModal.tsx` to verify the new "Dividend" option appears for mutual funds and renders the correct fields.